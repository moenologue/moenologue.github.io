"use strict";(self["webpackChunkcendana_web"]=self["webpackChunkcendana_web"]||[]).push([[745],{4745:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});a(246);var n=a(3673);const o=(0,n.Wm)("div",{class:"q-pa-sm"},[(0,n.Wm)("h6",{class:"q-my-none"},"Update Item")],-1);function l(e,t,a,l,i,r){const d=(0,n.up)("q-separator"),u=(0,n.up)("loading-pane"),s=(0,n.up)("q-input"),c=(0,n.up)("rupiah-input"),p=(0,n.up)("q-form"),m=(0,n.up)("q-card-section"),y=(0,n.up)("q-btn"),f=(0,n.up)("q-card-actions"),v=(0,n.up)("q-card"),g=(0,n.up)("q-dialog");return(0,n.wg)(),(0,n.j4)(g,{"model-value":!0,persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{flat:"",bordered:"",style:{width:"500px"}},{default:(0,n.w5)((()=>[o,(0,n.Wm)(d),"loading"==e.detail.type?((0,n.wg)(),(0,n.j4)(u,{key:0})):"data"==e.detail.type?((0,n.wg)(),(0,n.j4)(m,{key:1},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{ref:"form"},{default:(0,n.w5)((()=>[(0,n.Wm)(s,{type:"number",modelValue:e.payload.quantity,"onUpdate:modelValue":t[1]||(t[1]=t=>e.payload.quantity=t),modelModifiers:{number:!0},label:"QTY",class:"q-mb-md",min:1,max:e.detail.latestStock.quantity,rules:[e=>!!e||"Jumlah Barang Harus diisi",e=>e>0||"Jumlah Barang Harus lebih besar dari 0"]},null,8,["modelValue","max","rules"]),(0,n.Wm)(s,{type:"number",modelValue:e.payload.discount,"onUpdate:modelValue":t[2]||(t[2]=t=>e.payload.discount=t),modelModifiers:{number:!0},label:"Diskon",suffix:"%",class:"q-mb-md"},null,8,["modelValue"]),(0,n.Wm)(c,{label:"Harga Jual",modelValue:e.payload.sellPrice,"onUpdate:modelValue":t[3]||(t[3]=t=>e.payload.sellPrice=t),class:"q-mb-md"},null,8,["modelValue"]),(0,n.Wm)(s,{placeholder:"keterangan",type:"textarea",modelValue:e.payload.description,"onUpdate:modelValue":t[4]||(t[4]=t=>e.payload.description=t)},null,8,["modelValue"])])),_:1},512)])),_:1})):(0,n.kq)("",!0),(0,n.Wm)(d),(0,n.Wm)(f,{align:"center"},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{onClick:t[5]||(t[5]=t=>e.router.back()),label:"batal",unelevated:"",class:"q-mr-md"}),(0,n.Wm)(y,{onClick:e.onSubmit,loading:"loading"==e.updateResult.type,unelevated:"",label:"simpan",dark:"",color:"primary"},null,8,["onClick","loading"])])),_:1})])),_:1})])),_:1})}var i=a(1959),r=a(8825),d=a(9582),u=a(3385),s=a(1768),c=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function i(e){try{d(n.next(e))}catch(t){l(t)}}function r(e){try{d(n["throw"](e))}catch(t){l(t)}}function d(e){e.done?a(e.value):o(e.value).then(i,r)}d((n=n.apply(e,t||[])).next())}))};function p(e){const t=e=>c(this,void 0,void 0,(function*(){const t=yield s.api.get(`/v1/api/products/${e}`);return t.data})),a=e=>c(this,void 0,void 0,(function*(){const t=yield s.api.get(`/v1/api/latest-stock/${e}`);return t.data})),n=e=>c(this,void 0,void 0,(function*(){const t=yield s.api.get(`/v1/api/order-items/${e}`);return t.data})),o=(0,i.iH)({type:"loading"}),l=(0,r.Z)(),d=()=>c(this,void 0,void 0,(function*(){o.value={type:"loading"};const i=e.value;try{const e=yield n(i),l=yield t(e.productId),r=yield a(l.id);o.value={type:"data",orderItem:e,product:l,latestStock:r}}catch(r){console.log(r),o.value={type:"error",error:r},l.notify({type:"negative",message:"Terjadi kesalahan saat mengambil data item Penjualan"})}return o.value}));return{getDetail:d,result:o}}var m=a(4964),y=a(7300),f=a(7763),v=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function i(e){try{d(n.next(e))}catch(t){l(t)}}function r(e){try{d(n["throw"](e))}catch(t){l(t)}}function d(e){e.done?a(e.value):o(e.value).then(i,r)}d((n=n.apply(e,t||[])).next())}))};const g=(0,n.aZ)({components:{FreeProductForOrder:y.Z,RupiahInput:u.Z,LoadingPane:f.Z},props:{saleItemId:{type:String,required:!0}},emits:["done"],setup(e,{emit:t}){const a=(0,i.qj)({quantity:1,sellPrice:"0",discount:0,description:""}),o=(0,i.Vh)(e,"saleItemId"),{result:l,getDetail:u}=p(o);(0,n.bv)((()=>{u().then((e=>{"data"==e.type&&(a.discount=e.orderItem.discount,a.sellPrice=e.orderItem.sellPrice,a.quantity=e.orderItem.quantity,a.description=e.orderItem.description)}))}));const s=(0,d.tv)(),c=(0,r.Z)(),y=(0,i.iH)(null),{result:f,updateEntity:g}=(0,m.oN)("Item Penjualan"),h=()=>v(this,void 0,void 0,(function*(){const e=y.value;if(!e)return void c.notify({type:"negative",message:"Terjadi kesalahan saat melakukan validasi"});const t=yield e.validate(!0);if(!t)return;const n=`/v1/api/order-items/${o.value}`;g(n,Object.assign({},a)).then((()=>{s.back()}))}));return{detail:l,payload:a,form:y,onSubmit:h,updateResult:f,router:s}}});var h=a(6778),b=a(151),q=a(5869),k=a(5589),w=a(5269),I=a(4842),Z=a(9367),V=a(2165),W=a(7518),P=a.n(W);g.render=l;const j=g;P()(g,"components",{QDialog:h.Z,QCard:b.Z,QSeparator:q.Z,QCardSection:k.Z,QForm:w.Z,QInput:I.Z,QCardActions:Z.Z,QBtn:V.Z})}}]);