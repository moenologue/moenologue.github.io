"use strict";(self["webpackChunkcendana_web"]=self["webpackChunkcendana_web"]||[]).push([[312],{7312:(e,t,a)=>{a.r(t),a.d(t,{default:()=>A});var l=a(3673),o=a(2323);const n={key:0,class:"text-uppercase text-weight-bold"},r=(0,l.Uk)("Update Jumlah Rusak"),d={class:"q-px-lg"};function i(e,t,a,i,u,p){const s=(0,l.up)("q-toolbar-title"),c=(0,l.up)("q-toolbar"),m=(0,l.up)("q-separator"),f=(0,l.up)("router-link"),g=(0,l.up)("q-td"),w=(0,l.up)("q-item-label"),b=(0,l.up)("q-item-section"),y=(0,l.up)("q-item"),q=(0,l.up)("q-list"),h=(0,l.up)("q-btn-dropdown"),k=(0,l.up)("q-table"),v=(0,l.up)("pagination"),W=(0,l.up)("loading-pane"),Z=(0,l.up)("update-defect"),U=(0,l.up)("q-dialog"),_=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(_,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"q-px-lg bg-grey-2"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"text-weight-bold"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Data Pembelian Produk#"+(0,o.zw)(e.id)+" ",1),"result"==e.product.type?((0,l.wg)(),(0,l.j4)("span",n,(0,o.zw)(e.product.data.name),1)):(0,l.kq)("",!0)])),_:1})])),_:1}),(0,l.Wm)(m),"data"==e.purchases.type?((0,l.wg)(),(0,l.j4)(l.HY,{key:0},[(0,l.Wm)(k,{columns:e.columns,rows:e.purchases.items,"rows-per-page-options":[0],flat:"","hide-pagination":""},{"body-cell-order":(0,l.w5)((e=>[(0,l.Wm)(g,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{to:`/app/purchase/${e.row.orderId}/detail`},{default:(0,l.w5)((()=>[(0,l.Uk)("#"+(0,o.zw)(e.row.orderId),1)])),_:2},1032,["to"])])),_:2},1032,["props"])])),"body-cell-actions":(0,l.w5)((t=>[(0,l.Wm)(g,{props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{color:"primary",outline:"",size:"xs",icon:"more_horiz"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{separator:""},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{clickable:"",onClick:a=>e.onUpdateDefect(t.row.id)},{default:(0,l.w5)((()=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(w,null,{default:(0,l.w5)((()=>[r])),_:1})])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:1},8,["columns","rows"]),(0,l.Wm)(m),(0,l.Wm)("section",d,[(0,l.Wm)(c,{class:"text-grey-8 q-py-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{page:e.params.page,"onUpdate:page":t[1]||(t[1]=t=>e.params.page=t),"per-page":e.params.perPage,"onUpdate:per-page":t[2]||(t[2]=t=>e.params.perPage=t),"total-page":e.purchases.totalPage},null,8,["page","per-page","total-page"])])),_:1})])],64)):((0,l.wg)(),(0,l.j4)(W,{key:1})),(0,l.Wm)(U,{modelValue:e.showUpdateDefect,"onUpdate:modelValue":t[3]||(t[3]=t=>e.showUpdateDefect=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{id:e.selectedId,"product-id":e.id,onDone:e.onDoneUpdateDefect},null,8,["id","product-id","onDone"])])),_:1},8,["modelValue"])])),_:1})}var u=a(1959),p=a(4240),s=a(7746),c=a(3529),m=a(4964),f=a(2273),g=a(7763),w=a(7179);const b={key:0,class:"q-pa-sm"},y={class:"q-my-none"};function q(e,t,a,n,r,d){const i=(0,l.up)("q-separator"),u=(0,l.up)("q-input"),p=(0,l.up)("q-form"),s=(0,l.up)("q-card-section"),c=(0,l.up)("q-btn"),m=(0,l.up)("q-card-actions"),f=(0,l.up)("q-card");return(0,l.wg)(),(0,l.j4)(f,{flat:"",bordered:"",style:{width:"500px"}},{default:(0,l.w5)((()=>["result"==e.product.type?((0,l.wg)(),(0,l.j4)("div",b,[(0,l.Wm)("h6",y,(0,o.zw)(e.product.data.name)+" -- Ubah Jumlah Rusak",1)])):(0,l.kq)("",!0),(0,l.Wm)(i),(0,l.Wm)(s,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{ref:"form"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:e.payload.defect,"onUpdate:modelValue":t[1]||(t[1]=t=>e.payload.defect=t),type:"number",min:0,max:e.maxDefect,label:"Jumlah Rusak"},null,8,["modelValue","max"])])),_:1},512)])),_:1}),(0,l.Wm)(i),(0,l.Wm)(m,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{onClick:e.onSubmit,loading:"loading"==e.updateResult.type,outline:"",color:"primary",label:"submit"},null,8,["onClick","loading"])])),_:1})])),_:1})}var h=function(e,t,a,l){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function r(e){try{i(l.next(e))}catch(t){n(t)}}function d(e){try{i(l["throw"](e))}catch(t){n(t)}}function i(e){e.done?a(e.value):o(e.value).then(r,d)}i((l=l.apply(e,t||[])).next())}))};const k=(0,l.aZ)({props:{id:{type:[Number,String]},productId:{type:Number,required:!0}},emits:["done"],setup(e,{emit:t}){const a=(0,u.Vh)(e,"id"),o=(0,u.qj)({defect:0}),{result:n,getSingleEntity:r}=(0,m.pk)("Stok Item"),d=()=>h(this,void 0,void 0,(function*(){const e=(0,u.SU)(a);console.log(`id changed = ${e}`),yield r(`/v1/api/stock-items/${e}`)}));(0,l.YP)(a,d);const i=(0,l.Fl)((()=>{const e=(0,u.SU)(n);if("result"!=e.type)return 0;const{data:t}=e,{available:a}=t;return a})),{result:p,getSingleEntity:s}=(0,m.pk)("Product"),c=()=>h(this,void 0,void 0,(function*(){const t=e.productId,a=`/v1/api/products/${t}`;yield s(a)}));(0,l.bv)(c);const{result:f,updateEntity:g}=(0,m.lW)({entityName:"Stok Barang"}),w=(0,u.iH)(null),b=()=>h(this,void 0,void 0,(function*(){const e=(0,u.SU)(w);if(!e)throw new Error("form is undefined");const l=yield e.validate(!0);if(!l)throw new Error("form is not valid");const n=(0,u.SU)(a);g(`/v1/api/stock-items/${n}/defect`,o).then((()=>{t("done")}))}));return{product:p,payload:o,maxDefect:i,form:w,onSubmit:b,updateResult:f}}});var v=a(151),W=a(5869),Z=a(5589),U=a(5269),_=a(4842),D=a(9367),Q=a(2165),P=a(7518),S=a.n(P);k.render=q;const x=k;S()(k,"components",{QCard:v.Z,QSeparator:W.Z,QCardSection:Z.Z,QForm:U.Z,QInput:_.Z,QCardActions:D.Z,QBtn:Q.Z});const I=[{name:"createdAt",align:"left",field:"createdAt",label:"",required:!0,format:e=>(0,p.Z)(new Date(e),"d MMMM yyyy, HH:mm",{locale:s.Z})},{name:"order",align:"left",field:"orderId",label:"Order",required:!0},{name:"buyPrice",align:"left",field:"buyPrice",label:"Harga Beli",required:!0,format:e=>(0,f.z)(e)},{name:"sellPrice",align:"left",field:"sellPrice",label:"Harga Jual",required:!0,format:e=>(0,f.z)(e)},{name:"discount",align:"left",field:"discount",label:"Diskon",required:!0,format:e=>e+"%"},{name:"available",align:"left",field:"available",label:"Tersedia",required:!0},{name:"sold",align:"left",field:"sold",label:"Terjual",required:!0},{name:"defect",align:"left",field:"defect",label:"Rusak",required:!0},{name:"quantity",align:"left",field:"quantity",label:"Total",required:!0},{name:"actions",align:"left",field:"id",label:"",required:!0}],C=(0,l.aZ)({props:{id:{type:String,required:!0}},components:{LoadingPane:g.Z,Pagination:w.Z,UpdateDefect:x},setup(e){const t=(0,u.Vh)(e,"id"),{result:a,getSingleEntity:o}=(0,m.pk)("Produk"),n=()=>o(`/v1/api/products/${t.value}`),{params:r,result:d,getPurchases:i}=(0,c.XE)(t);(0,l.YP)(r,i),(0,l.bv)((()=>{n(),i()}));const p=(0,u.iH)(0),s=e=>{p.value=e,f.value=!0},f=(0,u.iH)(!1);function g(){f.value=!1,i()}return{selectedId:p,product:a,params:r,purchases:d,columns:I,onUpdateDefect:s,showUpdateDefect:f,onDoneUpdateDefect:g}}});var j=a(4379),z=a(9570),H=a(3747),T=a(6429),V=a(3884),E=a(2670),R=a(7011),$=a(3414),B=a(2035),J=a(2350),M=a(6778);C.render=i;const A=C;S()(C,"components",{QPage:j.Z,QToolbar:z.Z,QToolbarTitle:H.Z,QSeparator:W.Z,QTable:T.Z,QTd:V.Z,QBtnDropdown:E.Z,QList:R.Z,QItem:$.Z,QItemSection:B.Z,QItemLabel:J.Z,QDialog:M.Z})}}]);