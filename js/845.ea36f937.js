"use strict";(self["webpackChunkcendana_web"]=self["webpackChunkcendana_web"]||[]).push([[845],{5845:(e,a,t)=>{t.r(a),t.d(a,{default:()=>ze});var l=t(3673);const n={class:"q-pa-md"},o={key:0,class:"row q-mb-xl q-col-gutter-md"},r={class:"col-12 col-md-4"},d=(0,l.Wm)("div",{class:"text-subtitle1 text-weight-bold"},"Informasi Penjualan",-1),u={key:0,class:"col-12 col-md-4"},i=(0,l.Wm)("div",{class:"text-subtitle1 text-weight-bold"},"Informasi Transaksi",-1),s={class:"row q-mb-xl"},p={class:"col-12"};function m(e,a,t,m,c,f){const y=(0,l.up)("btn-actions"),b=(0,l.up)("page-toolbar"),w=(0,l.up)("q-separator"),g=(0,l.up)("q-toolbar"),h=(0,l.up)("sale-card-info"),W=(0,l.up)("q-card"),q=(0,l.up)("transaction-flash"),v=(0,l.up)("order-items"),k=(0,l.up)("sale-update"),S=(0,l.up)("q-dialog"),Z=(0,l.up)("order-seal"),I=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(I,null,{default:(0,l.w5)((()=>[(0,l.Wm)(b,{title:`Detail Penjualan #${e.orderId}`},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{open:e.open,onShowSeal:a[1]||(a[1]=a=>e.showSealDialog=!0),onShowUpdate:a[2]||(a[2]=a=>e.showUpdateDialog=!0)},null,8,["open"])])),_:1},8,["title"]),(0,l.Wm)(w),(0,l.Wm)("div",n,["result"==e.sale.type?((0,l.wg)(),(0,l.j4)("div",o,[(0,l.Wm)("div",r,[(0,l.Wm)(W,{flat:"",bordered:""},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"bg-grey-2"},{default:(0,l.w5)((()=>[d])),_:1}),(0,l.Wm)(w),(0,l.Wm)(h,{sale:e.sale.data},null,8,["sale"])])),_:1})]),e.sale.data.transaction?((0,l.wg)(),(0,l.j4)("div",u,[(0,l.Wm)(W,{flat:"",bordered:""},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"bg-grey-2"},{default:(0,l.w5)((()=>[i])),_:1}),(0,l.Wm)(w),(0,l.Wm)(q,{transaction:e.sale.data.transaction},null,8,["transaction"])])),_:1})])):(0,l.kq)("",!0)])):(0,l.kq)("",!0),(0,l.Wm)("div",s,[(0,l.Wm)("div",p,[(0,l.Wm)(v,{onItemAdded:e.getSale,"order-id":e.orderId,open:e.open},null,8,["onItemAdded","order-id","open"])])])]),(0,l.Wm)(S,{modelValue:e.showUpdateDialog,"onUpdate:modelValue":a[3]||(a[3]=a=>e.showUpdateDialog=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{"order-id":e.orderId,onOrderSealed:e.getSale,style:{width:"500px"}},null,8,["order-id","onOrderSealed"])])),_:1},8,["modelValue"]),(0,l.Wm)(S,{modelValue:e.showSealDialog,"onUpdate:modelValue":a[4]||(a[4]=a=>e.showSealDialog=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{order:e.sale.data,style:{width:"500px"}},null,8,["order"])])),_:1},8,["modelValue"])])),_:1})}var c=t(1959),f=t(1036),y=t(2323);const b=(0,l.Uk)(" Pelanggan "),w=(0,l.Uk)(" Admin "),g=(0,l.Uk)(" Status Pembelian "),h=(0,l.Uk)(" Pajak "),W=(0,l.Uk)(" Diskon "),q=(0,l.Uk)(" Biaya Pengiriman "),v=(0,l.Uk)(" Total "),k=(0,l.Uk)(" Grand Total ");function S(e,a,t,n,o,r){const d=(0,l.up)("q-item-section"),u=(0,l.up)("router-link"),i=(0,l.up)("q-item"),s=(0,l.up)("order-status-chip"),p=(0,l.up)("q-list");return(0,l.wg)(),(0,l.j4)(p,{separator:""},{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[b])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{to:"/app"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,y.zw)(e.sale.targetUser.name),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[w])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{to:"/app"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,y.zw)(e.sale.author.name),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[g])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)("div",null,[(0,l.Wm)(s,{status:e.sale.orderStatus},null,8,["status"])])])),_:1})])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[h])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,y.zw)(e.sale.tax)+" % ",1)])),_:1})])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[W])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,y.zw)(e.sale.discount)+" % ",1)])),_:1})])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[q])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" Rp, "+(0,y.zw)(e.rupiah(e.sale.shipping)),1)])),_:1})])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[v])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" Rp, "+(0,y.zw)(e.rupiah(e.sale.total)),1)])),_:1})])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[k])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" Rp, "+(0,y.zw)(e.rupiah(e.sale.grandTotal)),1)])),_:1})])),_:1})])),_:1})}var Z=t(2273),I=t(4561);const _=(0,l.aZ)({props:{sale:{type:Object,required:!0}},components:{OrderStatusChip:I.Z},emits:["update"],setup(e,{emit:a}){return{rupiah:Z.z}}});var j=t(7011),U=t(3414),P=t(2035),O=t(7518),V=t.n(O);_.render=S;const Q=_;V()(_,"components",{QList:j.Z,QItem:U.Z,QItemSection:P.Z});const x={style:{display:"flex","justify-content":"center"}};function T(e,a,t,n,o,r){const d=(0,l.up)("q-btn");return(0,l.wg)(),(0,l.j4)("div",x,[e.open?((0,l.wg)(),(0,l.j4)(d,{key:0,onClick:a[1]||(a[1]=a=>e.$emit("show-seal")),label:"kunci transaksi",outline:"",class:"q-mr-md"})):(0,l.kq)("",!0),e.open?((0,l.wg)(),(0,l.j4)(d,{key:1,onClick:a[2]||(a[2]=a=>e.$emit("show-update")),label:"edit data penjualan",outline:"",icon:"edit"})):(0,l.kq)("",!0)])}const D=(0,l.aZ)({emits:["show-update","show-seal"],props:{open:{type:Boolean,required:!0}}});var C=t(2165);D.render=T;const A=D;V()(D,"components",{QBtn:C.Z});const E=(0,l.Uk)("Daftar Item");function H(e,a,t,n,o,r){const d=(0,l.up)("q-toolbar-title"),u=(0,l.up)("q-btn"),i=(0,l.up)("q-toolbar"),s=(0,l.up)("q-separator"),p=(0,l.up)("order-item-table"),m=(0,l.up)("q-card"),c=(0,l.up)("order-item-add"),f=(0,l.up)("q-dialog");return(0,l.wg)(),(0,l.j4)("div",null,[(0,l.Wm)(m,{bordered:"",flat:""},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{class:"bg-grey-2"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"text-subtitle1 text-weight-bold"},{default:(0,l.w5)((()=>[E])),_:1}),e.open?((0,l.wg)(),(0,l.j4)(u,{key:0,onClick:a[1]||(a[1]=a=>e.showAddDialog=!0),icon:"add",label:"tambah item",outline:""})):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(s),"data"==e.orderItems.type?((0,l.wg)(),(0,l.j4)(p,{key:0,open:e.open,orderItems:e.orderItems.items},null,8,["open","orderItems"])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(f,{modelValue:e.showAddDialog,"onUpdate:modelValue":a[2]||(a[2]=a=>e.showAddDialog=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{onItemAdded:e.onItemAdded,"order-id":e.orderId,style:{width:"500px"}},null,8,["onItemAdded","order-id"])])),_:1},8,["modelValue"])])}var B=t(4964),M=t(7179);const z={class:"text-weight-bold"};function F(e,a,t,n,o,r){const d=(0,l.up)("router-link"),u=(0,l.up)("q-td"),i=(0,l.up)("q-btn"),s=(0,l.up)("q-table");return(0,l.wg)(),(0,l.j4)(s,{flat:"","hide-pagination":"",columns:e.columns,rows:e.orderItems,"rows-per-page-options":[0]},{"body-cell-product":(0,l.w5)((e=>[(0,l.Wm)(u,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{to:`/app/product/${e.row.product.id}/detail`},{default:(0,l.w5)((()=>[(0,l.Wm)("div",z,(0,y.zw)(e.row.product.name),1)])),_:2},1032,["to"])])),_:2},1032,["props"])])),"body-cell-actions":(0,l.w5)((a=>[(0,l.Wm)(u,{props:a},{default:(0,l.w5)((()=>[e.open?((0,l.wg)(),(0,l.j4)(i,{key:0,icon:"delete",color:"red",flat:"",size:"sm"})):(0,l.kq)("",!0)])),_:2},1032,["props"])])),_:1},8,["columns","rows"])}var R=t(5387),N=t.n(R);const L=[{name:"id",align:"left",field:"id",label:"id",required:!0},{name:"product",align:"left",field:e=>e.product.name,label:"Produk",required:!0},{name:"buyPrice",align:"left",field:"buyPrice",label:"Harga Beli",format:e=>(0,Z.z)(e),required:!0},{name:"sellPrice",align:"left",field:"sellPrice",label:"Harga Jual",format:e=>(0,Z.z)(e),required:!0},{name:"discount",align:"left",field:"discount",format:e=>e+" %",label:"Diskon",required:!0},{name:"quantity",align:"left",field:"quantity",label:"QTY",required:!0},{name:"subtot",align:"left",field:e=>{const a=new(N())(e.sellPrice).mul(new(N())(e.quantity)),t=a.sub(a.mul(new(N())(e.discount/100)));return(0,Z.z)(t.toString())},label:"",required:!0},{name:"actions",align:"right",field:"id",label:""}],Y=(0,l.aZ)({props:{open:{type:Boolean,required:!0},orderItems:{type:Array,required:!0}},emits:["update","delete","deleted"],setup(e,{emit:a}){return{columns:L}}});var $=t(6429),J=t(3884);Y.render=F;const G=Y;V()(Y,"components",{QTable:$.Z,QTd:J.Z,QBtn:C.Z});t(246);const K=(0,l.Uk)(" Tambah Item ");function X(e,a,t,n,o,r){const d=(0,l.up)("q-toolbar-title"),u=(0,l.up)("q-toolbar"),i=(0,l.up)("free-product-for-order"),s=(0,l.up)("rupiah-input"),p=(0,l.up)("q-input"),m=(0,l.up)("q-card-section"),c=(0,l.up)("q-btn"),f=(0,l.up)("q-card-actions"),y=(0,l.up)("q-form"),b=(0,l.up)("q-card");return(0,l.wg)(),(0,l.j4)(b,{flat:"",bordered:""},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"bg-grey-2"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[K])),_:1})])),_:1}),(0,l.Wm)(y,{ref:"form",onSubmit:e.onSubmit},{default:(0,l.w5)((()=>[(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,{modelValue:e.payload.product,"onUpdate:modelValue":a[1]||(a[1]=a=>e.payload.product=a),"order-id":e.orderId,class:"q-mb-md",rules:[e=>!!e||"Produk Harus diisi"]},null,8,["modelValue","order-id","rules"]),(0,l.Wm)(s,{label:"Harga Jual",modelValue:e.payload.sellPrice,"onUpdate:modelValue":a[2]||(a[2]=a=>e.payload.sellPrice=a),rules:[e.decGreaterThan("0","Harga Jual harus lebih besar dari 0")]},null,8,["modelValue","rules"]),(0,l.Wm)(p,{class:"q-mb-md",label:"Jumlah Item",modelValue:e.payload.quantity,"onUpdate:modelValue":a[3]||(a[3]=a=>e.payload.quantity=a),modelModifiers:{number:!0},type:"number",max:e.maxQTY,rules:[e=>!!e||"Jumlah Item Harus Diisi",e.ruleMaxQTY]},null,8,["modelValue","max","rules"]),(0,l.Wm)(p,{class:"q-mb-md",label:"Diskon",type:"number",min:"0",max:"100",modelValue:e.payload.discount,"onUpdate:modelValue":a[4]||(a[4]=a=>e.payload.discount=a),modelModifiers:{number:!0}},null,8,["modelValue"]),(0,l.Wm)(p,{placeholder:"keterangan",type:"textarea",modelValue:e.payload.description,"onUpdate:modelValue":a[5]||(a[5]=a=>e.payload.description=a)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(f,{align:"center",class:"bg-grey-2"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{type:"submit",label:"Simpan",color:"primary",unelevated:"",dark:""})])),_:1})])),_:1},8,["onSubmit"])])),_:1})}var ee=t(7300),ae=t(3385),te=t(2386),le=function(e,a,t,l){function n(e){return e instanceof t?e:new t((function(a){a(e)}))}return new(t||(t=Promise))((function(t,o){function r(e){try{u(l.next(e))}catch(a){o(a)}}function d(e){try{u(l["throw"](e))}catch(a){o(a)}}function u(e){e.done?t(e.value):n(e.value).then(r,d)}u((l=l.apply(e,a||[])).next())}))},ne=function(e,a){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&a.indexOf(l)<0&&(t[l]=e[l]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(l=Object.getOwnPropertySymbols(e);n<l.length;n++)a.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]])}return t};const oe=(0,l.aZ)({props:{orderId:{type:[Number,String],required:!0}},components:{FreeProductForOrder:ee.Z,RupiahInput:ae.Z},emits:["item-added"],setup(e,{emit:a}){const t=(0,c.iH)(),n=(0,c.iH)(0),o=(0,c.qj)({product:{},quantity:1,sellPrice:"0",discount:0,description:""}),r=(0,c.Vh)(o,"product");(0,l.YP)(r,(e=>{e&&e.id&&(o.sellPrice=e.sellPrice,o.discount=e.discount,n.value=e.available,console.log("maxQTY.value = ",n.value))}));const d="jumlah item tidak boleh melebihi batas maksimal",u=e=>e<=n.value||d,i=(0,l.f3)("user"),{result:s,createEntity:p}=(0,B.Zh)({entityName:"Item Penjualan",transform:a=>{const t=(0,c.SU)(i);if(!t)throw new Error("user is undefined");const{product:l}=a,n=ne(a,["product"]);return Object.assign(Object.assign({},n),{productId:l.id,orderId:e.orderId,authorId:t.id})}}),m=()=>le(this,void 0,void 0,(function*(){const e="/v1/api/order-items",l=(0,c.SU)(t),n=yield l.validate(!0);if(n)try{yield p(e,o),a("item-added")}catch(r){console.log(r)}}));return{form:t,payload:o,result:s,decGreaterThan:te.b,onSubmit:m,maxQTY:n,ruleMaxQTY:u}}});var re=t(151),de=t(9570),ue=t(3747),ie=t(5269),se=t(5589),pe=t(4842),me=t(9367);oe.render=X;const ce=oe;V()(oe,"components",{QCard:re.Z,QToolbar:de.Z,QToolbarTitle:ue.Z,QForm:ie.Z,QCardSection:se.Z,QInput:pe.Z,QCardActions:me.Z,QBtn:C.Z});const fe=(0,l.aZ)({props:{orderId:{type:[Number,String],required:!0},open:{type:Boolean,required:!0}},components:{Pagination:M.Z,OrderItemTable:G,OrderItemAdd:ce},emits:["item-added"],setup(e,{emit:a}){(0,c.Vh)(e,"orderId");const{params:t,getEntities:n,result:o}=(0,B.IT)({url:"/v1/api/order-items",name:"Item Penjualan",initialParams:{target:0,type:"ORDER"}});(0,l.bv)((()=>{t.target=e.orderId}));const r=(0,c.iH)(!1);function d(){r.value=!1,a("item-added"),n()}return{foo:"bar",orderItems:o,params:t,showAddDialog:r,onItemAdded:d}}});var ye=t(5869),be=t(6778);fe.render=H;const we=fe;V()(fe,"components",{QCard:re.Z,QToolbar:de.Z,QToolbarTitle:ue.Z,QBtn:C.Z,QSeparator:ye.Z,QDialog:be.Z});const ge=(0,l.Wm)("div",{class:"q-pa-sm"},[(0,l.Wm)("h6",{class:"q-my-none"},"Edit Penjualan")],-1);function he(e,a,t,n,o,r){const d=(0,l.up)("q-separator"),u=(0,l.up)("q-card-section"),i=(0,l.up)("customer-search-input"),s=(0,l.up)("q-input"),p=(0,l.up)("rupiah-input"),m=(0,l.up)("q-form"),c=(0,l.up)("q-btn"),f=(0,l.up)("q-card-actions"),y=(0,l.up)("q-card");return(0,l.wg)(),(0,l.j4)(y,{flat:"",bordered:""},{default:(0,l.w5)((()=>[ge,(0,l.Wm)(d),"loading"==e.sale.type?((0,l.wg)(),(0,l.j4)(u,{key:0})):((0,l.wg)(),(0,l.j4)(m,{key:1,ref:"form"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,{modelValue:e.payload.targetUser,"onUpdate:modelValue":a[1]||(a[1]=a=>e.payload.targetUser=a)},null,8,["modelValue"]),(0,l.Wm)(s,{label:"Pajak (%)",class:"q-mb-md",modelValue:e.payload.tax,"onUpdate:modelValue":a[2]||(a[2]=a=>e.payload.tax=a),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"]),(0,l.Wm)(p,{label:"Biaya Pengiriman (IDR)",modelValue:e.payload.shipping,"onUpdate:modelValue":a[3]||(a[3]=a=>e.payload.shipping=a)},null,8,["modelValue"]),(0,l.Wm)(s,{label:"Diskon (%)",class:"q-mb-md",modelValue:e.payload.discount,"onUpdate:modelValue":a[4]||(a[4]=a=>e.payload.discount=a),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])])),_:1})])),_:1},512)),(0,l.Wm)(d),(0,l.Wm)(f,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"simpan",color:"primary",onClick:e.onSubmit},null,8,["onClick"])])),_:1})])),_:1})}var We=t(1289),qe=function(e,a,t,l){function n(e){return e instanceof t?e:new t((function(a){a(e)}))}return new(t||(t=Promise))((function(t,o){function r(e){try{u(l.next(e))}catch(a){o(a)}}function d(e){try{u(l["throw"](e))}catch(a){o(a)}}function u(e){e.done?t(e.value):n(e.value).then(r,d)}u((l=l.apply(e,a||[])).next())}))},ve=function(e,a){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&a.indexOf(l)<0&&(t[l]=e[l]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(l=Object.getOwnPropertySymbols(e);n<l.length;n++)a.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]])}return t};const ke=(0,l.aZ)({props:{orderId:{type:String,required:!0}},components:{RupiahInput:ae.Z,CustomerSearchInput:We.Z},emits:["sale-updated"],setup(e,{emit:a}){const t="Penjualan",n=(0,l.Fl)((()=>`/v1/api/sales/${e.orderId}`)),{result:o,getSingleEntity:r}=(0,B.ZM)({entityName:t,url:n}),d=(0,c.qj)({targetUser:{},tax:0,discount:0,shipping:"0"});function u(){r().then((e=>{alert("here"),console.log(e),d.targetUser=e.targetUser,d.tax=e.tax,d.discount=e.discount,d.shipping=e.shipping}))}(0,l.bv)(u);const i=(0,c.iH)(null),{updateEntity:s}=(0,B.lW)({entityName:t,transform:e=>{const{targetUser:a}=e,t=ve(e,["targetUser"]);return Object.assign(Object.assign({},t),{targetUserId:a.id})}});function p(){return qe(this,void 0,void 0,(function*(){const e=(0,c.SU)(i),t=yield e.validate(!0);t&&s(n.value,d).then((()=>a("sale-updated")))}))}return{sale:o,form:i,onSubmit:p,payload:d}}});ke.render=he;const Se=ke;V()(ke,"components",{QCard:re.Z,QSeparator:ye.Z,QCardSection:se.Z,QForm:ie.Z,QInput:pe.Z,QCardActions:me.Z,QBtn:C.Z});const Ze=(0,l.Wm)("div",{class:"q-pa-sm"},[(0,l.Wm)("h6",{class:"q-my-none"},"Kunci Transaksi")],-1),Ie={class:"text-weight-bold"};function _e(e,a,t,n,o,r){const d=(0,l.up)("q-separator"),u=(0,l.up)("payment-method-options"),i=(0,l.up)("rupiah-input"),s=(0,l.up)("q-input"),p=(0,l.up)("q-btn"),m=(0,l.up)("q-card-section"),c=(0,l.up)("q-card");return(0,l.wg)(),(0,l.j4)(c,{flat:"",bordered:"",style:{width:"500px"}},{default:(0,l.w5)((()=>[Ze,(0,l.Wm)(d),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)("div",Ie," Kode Transaksi = #"+(0,y.zw)(e.order.id),1),(0,l.Wm)(u,{modelValue:e.payload.paymentMethod,"onUpdate:modelValue":a[1]||(a[1]=a=>e.payload.paymentMethod=a)},null,8,["modelValue"]),(0,l.Wm)(i,{label:"Total Bayar",modelValue:e.payload.nominal,"onUpdate:modelValue":a[2]||(a[2]=a=>e.payload.nominal=a)},null,8,["modelValue"]),e.needDelay?((0,l.wg)(),(0,l.j4)(l.HY,{key:0},[(0,l.Wm)(i,{label:"Total Hutang",readonly:"","model-value":e.debt.toString()},null,8,["model-value"]),(0,l.Wm)(s,{class:"q-mb-md",outlined:"",label:"Batas Waktu Pembayaran Hutang",type:"number",modelValue:e.payload.elapsedDelay,"onUpdate:modelValue":a[3]||(a[3]=a=>e.payload.elapsedDelay=a),modelModifiers:{number:!0},min:"0"},null,8,["modelValue"])],64)):(0,l.kq)("",!0),(0,l.Wm)(p,{onClick:e.onSubmit,loading:e.sealLoading,label:"simpan",unelevated:"",color:"blue",dark:""},null,8,["onClick","loading"])])),_:1}),(0,l.Wm)(d)])),_:1})}var je,Ue=t(6635),Pe=t(891),Oe=t(1768),Ve=t(8825),Qe=t(9582),xe=function(e,a,t,l){function n(e){return e instanceof t?e:new t((function(a){a(e)}))}return new(t||(t=Promise))((function(t,o){function r(e){try{u(l.next(e))}catch(a){o(a)}}function d(e){try{u(l["throw"](e))}catch(a){o(a)}}function u(e){e.done?t(e.value):n(e.value).then(r,d)}u((l=l.apply(e,a||[])).next())}))};function Te(e){const a=(0,l.f3)("user"),t=(0,Ve.Z)(),n=(0,Qe.tv)(),o=(0,c.iH)(!1),r=(l,r)=>xe(this,void 0,void 0,(function*(){if(o.value=!0,!a)throw new Error("user is undefined");const d=a.value.id,u=Object.assign(Object.assign({},r),{authorId:d}),i=`/v1/api/${e}/${l}/seal`;try{yield Oe.api.put(i,u),t.notify({type:"positive",message:"Penjualan berhasil dikunci"})}catch(s){console.log(s),t.notify({type:"negative",message:"Gagal mengunci Penjualan"})}finally{o.value=!1,n.back()}}));return{seal:r,loading:o}}(function(e){e["PURCHASE"]="purchases",e["SALE"]="sales"})(je||(je={}));var De=t(6729),Ce=function(e,a){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&a.indexOf(l)<0&&(t[l]=e[l]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(l=Object.getOwnPropertySymbols(e);n<l.length;n++)a.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]])}return t};const Ae=(0,l.aZ)({components:{RupiahInput:ae.Z,PaymentMethodOptions:De.Z},props:{order:{type:Object,required:!0}},emits:["order-sealed"],setup(e,{emit:a}){const t=(0,c.Vh)(e,"order"),n=(0,c.qj)({nominal:"0",status:Pe.LN.SUCCESS,paymentMethod:Pe.XL.CASH,elapsedDelay:30}),o=(0,l.Fl)((()=>{const e=(0,c.SU)(t),a=(n.nominal,new(N())(n.nominal)),l=new(N())(e.grandTotal),o=l.sub(a);return o})),r=(0,l.Fl)((()=>o.value.greaterThan(0))),{seal:d,loading:u}=Te(je.SALE),i=()=>{const{elapsedDelay:e}=n,l=Ce(n,["elapsedDelay"]);let o=Object.assign({},l);r.value&&(o.delay={dueDate:(0,Ue.Z)(new Date,e)}),d(t.value.id,o).then((()=>{a("order-sealed")}))};return(0,l.bv)((()=>{n.nominal=t.value.grandTotal})),{payload:n,PAYMENT_METHOD_OPTIONS:Pe.x$,debt:o,needDelay:r,onSubmit:i,sealLoading:u}}});Ae.render=_e;const Ee=Ae;V()(Ae,"components",{QCard:re.Z,QSeparator:ye.Z,QCardSection:se.Z,QInput:pe.Z,QBtn:C.Z});var He=t(4465);const Be=(0,l.aZ)({components:{PageToolbar:f.Z,BtnActions:A,SaleCardInfo:Q,OrderItems:we,SaleUpdate:Se,OrderSeal:Ee,TransactionFlash:He.Z},props:{orderId:{type:String,required:!0}},setup(e){const a=(0,l.Fl)((()=>`/v1/api/sales/${e.orderId}`)),t="Penjualan",{result:n,getSingleEntity:o}=(0,B.ZM)({url:a,entityName:t});(0,l.bv)(o);const r=(0,l.Fl)((()=>{const e=(0,c.SU)(n);if("result"!=e.type)return!1;const a="OPEN"==e.data.orderStatus;return console.log("result = ",a),a})),d=(0,Qe.yj)(),u=(0,l.Fl)((()=>d.fullPath+"/update")),i=(0,l.Fl)((()=>d.fullPath+"/seal")),s=(0,c.iH)(!1),p=(0,c.iH)(!1);return{route:d,updateURL:u,sealURL:i,sale:n,getSale:o,open:r,showUpdateDialog:s,showSealDialog:p}}});var Me=t(4379);Be.render=m;const ze=Be;V()(Be,"components",{QPage:Me.Z,QSeparator:ye.Z,QCard:re.Z,QToolbar:de.Z,QDialog:be.Z})}}]);